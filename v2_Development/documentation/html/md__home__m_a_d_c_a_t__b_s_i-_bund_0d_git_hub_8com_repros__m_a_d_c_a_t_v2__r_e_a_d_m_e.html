<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MADCAT v2: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MADCAT v2
   &#160;<span id="projectnumber">2.1.x</span>
   </div>
   <div id="projectbrief">Mass Attack Detection Acceptance Tools</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__home__m_a_d_c_a_t__b_s_i-_bund_0d_git_hub_8com_repros__m_a_d_c_a_t_v2__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line">                        ▄▄▄               ▄▄▄▄▄▄</div>
<div class="line">            ▀▄▄      ▄▓▓█▓▓▓█▌           ██▓██▓▓██▄     ▄▀</div>
<div class="line">               ▀▄▄▄▓█▓██   █▓█▌         █▓   ▓████████▀</div>
<div class="line">                  ▀███▓▓(o)██▓▌       ▐█▓█(o)█▓█████▀</div>
<div class="line">                    ▀▀██▓█▓▓█         ████▓███▀▀</div>
<div class="line">             ▄            ▀▀▀▀                          ▄</div>
<div class="line">           ▀▀█                                         ▐██▌</div>
<div class="line">             ██▄     ____------▐██████▌------___     ▄▄██</div>
<div class="line">            __█ █▄▄--   ___------▀▓▓▀-----___   --▄▄█ █▀__</div>
<div class="line">        __--   ▀█  ██▄▄▄▄    __--▄▓▓▄--__   ▄▄▄▄██  ██▀   --__</div>
<div class="line">    __--     __--▀█ ██  █▀▀█████▄▄▄▄▄▄███████  ██ █▀--__      --__</div>
<div class="line">__--     __--    __▀▀█  █  ██  ██▀▀██▀▀██  ██  █▀▀__    --__      --__</div>
<div class="line">    __--     __--     ▀███ ██  ██  ██  ██ ████▀     --__    --__</div>
<div class="line"> --      __--             ▀▀▀▀▀██▄▄██▄▄██▀▀▀▀           --__    -- bsi</div>
<div class="line">    __ --                                                   --__</div>
</div><!-- fragment --><p>In recent years, mass attacks on Internet users have steadily increased. Again and again new methods and patterns of attack come to light. One example was a major incident that affected 900,000 connections in Germany in 2016. However, many of these attempted attacks remain undetected or are not reported, because they do not lead to a correspondingly large impairment. Therefore, it is necessary to collect data on attacks and attempted attacks on the Internet. A well-known and widespread means of detecting such attempted attacks are honeypots. In addition, it is also possible to collect data on the longer-term, temporal development of mass attacks and thus make better forecasts of future developments. For this purpose MADCAT (Mass Attack Detection Connection Acceptance Tools) has been developed as a universal, honeypot-like thread detetecion suite with low interaction. A honeypot is a server that simulates or emulates common network services. Honeypots are used to obtain information about attack patterns and attacker behavior. If such a honeypot service is accessed, the corresponding actions are recorded and an alarm is triggered if necessary. The idea behind the operation of honeypot systems is to offer one or more services that are not in productive use by users and therefore cannot be found and accessed during normal operation. An attacker who searches for vulnerabilities in network components and cannot distinguish between real servers and honeypots will therefore probably be registered by a honeypot. Usually at least the IP address of the attacker, the time of the attack and the actions of the attacker are logged like used access data. Furthermore, in the case of simulated web forms or command lines and other services the inputs may be recorded in order to be able to trace the attempted attack. MADCAT is similar to a honeypot, because it records all contact attempts without being limited to certain services. Low interaction indicates that in the current version of MADCAT v1 answers to contact attempts are only given to the extent that is technically absolutely necessary to establish a connection between potential attacker and sensor in order to detect attack vectors if feasible. For MADCAT v2 a higher level of interaction with attackers is planned, e.g. to register unauthorized username/password combinations used by them.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
1. Requirements</h1>
<p>To compile and run MADCAT you need to have a Linux OS installed. It has been developed and tested on Ubuntu 18.04 and 20.04. Additionally you need to install the following packages:</p>
<h3><a class="anchor" id="autotoc_md7"></a>
MADCAT Binaries</h3>
<p>Build Essentials, Compiler, etc: </p><div class="fragment"><div class="line">sudo sudo apt-get gcc cmake build-essential</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md8"></a>
PCAP:</h4>
<div class="fragment"><div class="line">sudo sudo apt-get install libpcap0.8 libpcap-dev</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md9"></a>
LUA:</h4>
<div class="fragment"><div class="line">sudo sudo apt-get install liblua5.1-0 liblua5.1-0-dev</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md10"></a>
SSL:</h4>
<div class="fragment"><div class="line">sudo sudo apt-get install libssl1.1 libssl-dev</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md11"></a>
Python Postprocessors</h3>
<h4><a class="anchor" id="autotoc_md12"></a>
Python 3:</h4>
<div class="fragment"><div class="line">sudo sudo apt-get install python3-dev</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md13"></a>
Conntrack Tools:</h4>
<div class="fragment"><div class="line">sudo sudo apt-get install conntrack</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md14"></a>
Monitoring</h3>
<p><a class="anchor" id="autotoc_md15"></a></p><h5>Audit Deamon:</h5>
<div class="fragment"><div class="line">sudo sudo apt-get install auditd audispd-plugins audit.d</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16"></a>
Net Tools</h4>
<div class="fragment"><div class="line">sudo sudo apt-get install net-tools</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md17"></a>
PIP:</h4>
<div class="fragment"><div class="line">sudo apt install python3-pip</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md18"></a>
PS Utils:</h4>
<div class="fragment"><div class="line">sudo pip3 install psutil</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md19"></a>
LUA Parser</h4>
<div class="fragment"><div class="line">sudo pip3 install luaparser</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md20"></a>
Recommended for testing and debuging</h3>
<div class="fragment"><div class="line">sudo apt-get install gdb pkg-config strace valgrind</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md21"></a>
2. How to compile</h1>
<p>MADCAT is compiled with cmake and make. It is also prepared for cross-compilation for the target architectures armhf and aarch64. Example commands can be found in "run_cmake+make.sh"</p>
<h1><a class="anchor" id="autotoc_md22"></a>
3. How to use</h1>
<p>To succesfull run MADCAT you need a dedicated interface. An example configuration can be found in ./etc/madcat/config.lua, which must be customized for your needs and your environment.</p>
<p>For the TCP Module to work with all destination ports yout need to set a DNAT-Rule, given your local hostaddress is 192.168.1.100, the configured port MADCAT is running on is 65535 on interface enp0s8, this would be something like:</p>
<div class="fragment"><div class="line">sudo iptables -t nat -A PREROUTING -i enp0s8 -p tcp --dport 1:65534 -j DNAT --to 192.168.1.100:65535</div>
</div><!-- fragment --><p>For the UDP Module, especially when using its proxy functionality, you need to drop outbound ICMP destination unrechable messages:</p>
<div class="fragment"><div class="line">sudo iptables -I OUTPUT -p icmp --icmp-type destination-unreachable -j DROP</div>
</div><!-- fragment --><p>It is imporant to run the MADCAT Modules and Python Processors in the right order and with proper piping in the configured FIFOs and logs. Given the binaries located in /opt/madcat, the config in /etc/madact/config.lua and data directory /data, the content of an example run script can be found in ./scripts/run_madcat.sh. The content of the resulting logfile is intended to be send to e.g. an Elastic-Stack Server via filebeat for further analysis and visualization, but can also be analysed by any other means, of course (e.g. Python, Scilab, etc.)</p>
<p>Monitoring is configured by /etc/madcat/monitoring_config.py, which is directly sourced by <a class="el" href="monitoring_8py.html">monitoring.py</a> and thus can be run directly as root.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
4. FAQ's</h1>
<p>If you encounter e.g. libc releated errors in your cross compiling evironment, see ./documentation/in_case_of_linking_problems.md</p>
<h1><a class="anchor" id="autotoc_md24"></a>
5. Links, etc.</h1>
<p>MADCAT has been released under GPLv3, see <a class="el" href="_l_i_c_e_n_s_e_8md.html">LICENSE.md</a></p>
<p>RSP - A Really Simple Proxy by Giles Thomas GitHub: <a href="https://github.com/gpjt/rsp">https://github.com/gpjt/rsp</a> LICENSE: MIT Documentation: <a href="http://www.gilesthomas.com/2013/08/writing-a-reverse-proxyloadbalancer-from-the-ground-up-in-c-part-0/">http://www.gilesthomas.com/2013/08/writing-a-reverse-proxyloadbalancer-from-the-ground-up-in-c-part-0/</a> Gratefully adopted and modified for MADCAT with special thanks to Giles Thomas.</p>
<p>apt-check Macro by Michiel Sikkes <a href="#" onclick="location.href='mai'+'lto:'+'mic'+'hi'+'el@'+'ey'+'eso'+'pe'+'ned'+'.n'+'l'; return false;">michi<span style="display: none;">.nosp@m.</span>el@e<span style="display: none;">.nosp@m.</span>yesop<span style="display: none;">.nosp@m.</span>ened<span style="display: none;">.nosp@m.</span>.nl</a>, Michael Vogt <a href="#" onclick="location.href='mai'+'lto:'+'mvo'+'@d'+'ebi'+'an'+'.or'+'g'; return false;">mvo@d<span style="display: none;">.nosp@m.</span>ebia<span style="display: none;">.nosp@m.</span>n.org</a>, Scott James Remnant <a href="#" onclick="location.href='mai'+'lto:'+'sco'+'tt'+'@ub'+'un'+'tu.'+'co'+'m'; return false;">scott<span style="display: none;">.nosp@m.</span>@ubu<span style="display: none;">.nosp@m.</span>ntu.c<span style="display: none;">.nosp@m.</span>om</a> Git: <a href="https://git.launchpad.net/update-notifier/tree/data/apt_check.py">https://git.launchpad.net/update-notifier/tree/data/apt_check.py</a> LICENSE: GPLv2</p>
<p><a href="https://www.bsi.bund.de">https://www.bsi.bund.de</a></p>
<p><a href="https://github.com/BSI-Bund/">https://github.com/BSI-Bund/</a></p>
<p><a href="https://www.gilesthomas.com/">https://www.gilesthomas.com/</a></p>
<p><a href="https://www.elastic.co/">https://www.elastic.co/</a></p>
<p><a href="https://www.elastic.co/de/beats/filebeat">https://www.elastic.co/de/beats/filebeat</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
